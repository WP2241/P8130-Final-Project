---
title: "FinalProject"
author: "Hyewon Choi"
date: "12/8/2017"
output: html_document
---

```{r first}
library(readr)
library(readxl)
library(janitor)
library(tidyverse)
library(pander)
hos = read_excel("./data/GHProject_Dataset.xlsx") 

hos <- hos %>% 
  clean_names() %>% 
  select(patientid, visitid, admitdtm, losdays2, is30dayreadmit, mews, cindex, evisit, icu_flag, ageyear, gender, race, religion, maritalstatus, insurancetype, bmi:bpdiastolic)
  


 unique_visit <- hos %>% 
   group_by(patientid) %>% 
   filter(!duplicated(patientid))

hos_tidy <- unique_visit

summary_losdays2 = hos_tidy %>% 
  ungroup(patientid) %>% 
  dplyr::select(losdays2) %>%
  summarize( variable = names(.),
  n_observation = n(),
  mean = mean(losdays2),
  SD = sd(losdays2),
  minimum = min(losdays2),
  maximum = max(losdays2),
  median = median(losdays2))

summary_ageyear = hos_tidy %>% 
  ungroup(patientid) %>% 
  dplyr::select(ageyear) %>%
  summarize( variable = names(.),
  n_observation = n(),
  mean = mean(ageyear),
  SD = sd(ageyear),
  minimum = min(ageyear),
  maximum = max(ageyear),
  median = median(ageyear))

summary_evisit = hos_tidy %>% 
  ungroup(patientid) %>% 
  dplyr::select(evisit) %>%
  summarize( variable = names(.),
  n_observation = n(),
  mean = mean(evisit),
  SD = sd(evisit),
  minimum = min(evisit),
  maximum = max(evisit),
  median = median(evisit))


 summary = rbind(summary_losdays2, summary_ageyear, summary_evisit)
 pander(summary)
           
```

```{r second}
hos %>%
  ggplot(aes(x = losdays2)) + 
    geom_histogram()

y = log(hos$losdays2)

hos$gender = ifelse(hos$gender == "Male", 1, ifelse(hos$gender == "Female", 0, NA))

hos$race = ifelse(hos$race == "White", 0, ifelse(hos$race == "African Amer/Black", 1, ifelse(hos$race == "Asian", 2, ifelse(hos$race == "Native Amer/Alaskan", 3, ifelse(hos$race == "Natv Hawaii/Pacf Isl", 4, ifelse(hos$race == "Other/Multiracial", 5, NA))))))

hos$insurancetype = ifelse(hos$insurancetype == "Medicare", 0, ifelse(hos$insurancetype == "Medicaid", 1, ifelse(hos$insurancetype == "Private", 2, ifelse(hos$insurancetype == "NA", 3, NA))))
```

